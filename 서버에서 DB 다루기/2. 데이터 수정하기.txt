- 2.  데이터 수정하기
    
    작성한 게시글 내용들을 수정해보겠다. 우선 수정 페이지가 필요한데, new 페이지와 비슷하게 만들겠다.
    
    ```html
    	[edit.mustache]
    	{{>layers/header}}
    
    <form class="container" action="/edit" method="post">
        <div class="mb-3">
            <label>Title</label>
            <input type="text" name="title">
        </div>
        <div class="mb-3">
            <label>Content</label>
            <textarea cols="3", name="content"></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Enter</button>
    </form>
    
    {{>layers/footer}}
    ```
    
    그리고 show 페이지를 edit 페이지로 접근할 수 있게 만들기 위해 아래 코드를 추가한다.
    
    ```html
    	[show.mustache]
    <a href="/edit" class="btn btn-primary">Edit</a>
    ```
    
    이제 컨트롤러로 가서 edit 페이지를 보여주고, 어떻게 수정하는지 살펴보겠다. 이제부터 해야 할 과정에는 Edit를 눌렀을 때 edit 페이지 보여주기, edit 페이지에서는 기존에 작성한 데이터를 보여주기, Submit을 누르면 데이터를 제출해 해당 데이터 업데이트 하기 이다. 
    
    우선 edit 컨트롤러에서 해야 할 일은 현재 데이터를 DB에서 조회해 edit 페이지에 출력해주고, sumbit이 눌리면 그 데이터를 전송하는 것이다. show 페이지에 다음과 같은 코드를 추가해주자.
    
    ```html
    <a href="/edit/{{article.id}}" class="btn btn-primary">Edit</a>
    ```
    
    ```java
    	[ArticleController.java]
    	...
    		@GetMapping("/edit/{id}")
        public String edit(@PathVariable Long id, Model model) {
            ArticleEntity articleEntity = artRepo.findById(id).orElse(null);
            model.addAttribute("article", articleEntity);
            return "edit";
        }
        ...
    ```
    
    그리고 컨트롤러는 위와 같이 작성한다. 이제 edit에 보내준 데이터를 표기해주기만 하면 된다.
    
    ```java
    	[edit.mustache]
    <form class="container" action="/edit" method="post">
        <input type="hidden" name="id" value="{{article.id}}">
        <div class="mb-3">
            <label>Title</label>
            <input type="text" name="title" value="{{article.title}}">
        </div>
        <div class="mb-3">
            <label>Content</label>
            <textarea cols="3", name="content">{{article.content}}</textarea>
        </div>
        <button type="submit" class="btn btn-primary">Enter</button>
    </form>
    ```
    
    input 태그에 value를 추가해서 기존의 데이터를 표여주게 한다. 이때 id값도 히든 타입(안 보임)으로 넣은 이유는 서버로 데이터를 전송할 때 제목과 내용만 전송하면 어떤 데이터인지 특정할 수 없기에, 고윳값인 id도 같이 보내주기 위해 히든 타입으로 넣었다. 하지만 우리가 작성한 DTO는 id값이 없으므로 다음과 같이 수정한다.
    
    ```java
    	[ArticleForm.java]
    package com.example.firstproject.dto;
    
    import com.example.firstproject.entity.ArticleEntity;
    import lombok.ToString;
    
    @ToString
    public class ArticleForm {
        private Long id;
        private String title;
        private String content;
    
        public ArticleForm(Long id, String title, String content) {
    		    this.id = id;
            this.title = title;
            this.content = content;
        }
    
        public ArticleEntity toEntity() {
            return new ArticleEntity(id, title, content);
        }
    }
    ```
    
    마지막으로, 컨트롤러는 다음과 같이 작성한다.
    
    ```java
    	[ArticleController.java]
    	...
    	    @PostMapping("/edit")
        public String update(ArticleForm article) {
            ArticleEntity articleEntity = article.toEntity();
            ArticleEntity target = artRepo.findById(articleEntity.getId()).orElse(null);
    
            if (target != null)
                artRepo.save(articleEntity);
    
            return "redirect:/articles/"+articleEntity.getId();
        }
        ...
    ```
    
    여기서 매개변수로 받는 article은 새로 고칠 데이터이다. 하지만 기존의 가지고 있는 id값은 유지돼야 하므로, 해당 id 값을 가진 데이터가 있는지 DB에서 검색한다. target이 null이 아니라면(=해당 id를 가진 데이터가 DB에 존재한다면) 새 데이터를 save해준다. CrudRepository의 save메서드는 동일한 id를 가진 Entity의 경우 기존 값에 업데이트한다. 처음 들어오는 id라면 새로운 데이터로 작성한다. 마지막으로, 해당 게시글 show 페이지로 redirect해준다.
    
    참고로 SQL 명령어로 살펴보면 다음과 같다.
    
    ```java
    UPDATE (테이블명) SET (속성1=속성값1, 속성2=속성값2, ...) WHERE (조건);
    ```
    
    예를 들어, id가 1인 데이터의 content를 hi로, title을 you로 바꾼다면 다음과 같다.
    UPDATE article_entity SET content='hi', title='you' WHERE id=1;
